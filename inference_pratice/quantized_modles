import os
import sys
import onnx
import onnxruntime as ort

# filename = '../model_to_graph/Relay_compiler.py'
# module_name = 'other_script'

# # Create a module spec
# spec = importlib.util.spec_from_file_location(module_name, filename)

# # Import the module
# relay_compiler = importlib.util.module_from_spec(spec)
# spec.loader.exec_module(relay_compiler)

# prompt = "my favorite music is"
# model_name = "gpt2"

# model_onnx, input_ids = relay_compiler.transformer_torch_to_onnx(model_name, prompt, save = False)

model_path = '../model_to_graph/gpt2.onnx'
onnx_model = onnx.load(model_path)
onnx.checker.check_model(onnx_model)
